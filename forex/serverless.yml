
service: forex-lambda

provider:
  name: aws
  runtime: nodejs12.x
  region: us-east-1
  individually: true
#  httpApi:
#    id: 4e7mp3lhl9
  apiGateway:
     restApiId: wnax7mhcn8 # REST API resource ID. Default is generated by the framework
     restApiRootResourceId: oxnibo08gd


functions:
  getFXPrice:
    handler: src/getFXPrice/getFXPrice.handler
    role: arn:aws:iam::923654168085:role/fyniti-backend-services-lambda
    environment:
      UIAPP_PRIVATE_ES_URL: UIAPP_PRIVATE_ES_URL
      UIAPP_PRIVATE_ES_EXCHANGE_PRICE_COLLECTION: UIAPP_PRIVATE_ES_EXCHANGE_PRICE_COLLECTION
      UIAPP_PRIVATE_ES_AUTHORIZATION_TOKEN: UIAPP_PRIVATE_ES_AUTHORIZATION_TOKEN
    memorySize: 256
    timeout: 900
    package:
      exclude:
        - src/**
      include:
        - node_modules/**
        - package.json
        - src/getFXPrice/getFXPrice.js
    events:
        - http: # this is an API Gateway HTTP event trigger
            path: /test/getFXPrice
            method: post
            integration: lambda
            cors: true
            description: Description of what the lambda function does # optional, Description to publish to AWS
            memorySize: 512 # optional, in MB, default is 1024
            timeout: 10

  updateFXPrice:
    handler: src/updateFXPrice/updateFXPrice.handler
    role: arn:aws:iam::923654168085:role/fyniti-backend-services-lambda
    environment:
      FOREX_API_URL_PREFIX: FOREX_API_URL_PREFIX
      FOREX_API_URL_ACCESS_KEY: FOREX_API_URL_ACCESS_KEY
      UIAPP_PRIVATE_ES_URL: UIAPP_PRIVATE_ES_URL
      UIAPP_PRIVATE_ES_CURRENCIES_COLLECTION: UIAPP_PRIVATE_ES_CURRENCIES_COLLECTION
      UIAPP_PRIVATE_ES_EXCHANGE_PRICE_COLLECTION: UIAPP_PRIVATE_ES_EXCHANGE_PRICE_COLLECTION
      UIAPP_PRIVATE_ES_AUTHORIZATION_TOKEN: UIAPP_PRIVATE_ES_AUTHORIZATION_TOKEN
    memorySize: 256
    timeout: 900
    package:
      exclude:
        - src/**
      include:
        - node_modules/**
        - package.json
        - src/updateFXPrice/updateFXPrice.js
    events:
        - http: # this is an API Gateway HTTP event trigger
            path: /test/updateFXPrice
            method: post
            integration: lambda
            cors: true
            description: Description of what the lambda function does # optional, Description to publish to AWS
            memorySize: 512 # optional, in MB, default is 1024
            timeout: 10

  updateFXTechnicalIndicator:
    handler: src/updateFXTechnicalIndicator/updateFXTechnicalIndicator.handler
    role: arn:aws:iam::923654168085:role/fyniti-backend-services-lambda
    environment:
      FOREX_API_URL_PREFIX: FOREX_API_URL_PREFIX
      FOREX_API_URL_ACCESS_KEY: FOREX_API_URL_ACCESS_KEY
      UIAPP_PRIVATE_ES_URL: UIAPP_PRIVATE_ES_URL
      UIAPP_PRIVATE_ES_CURRENCIES_COLLECTION: UIAPP_PRIVATE_ES_CURRENCIES_COLLECTION
      UIAPP_PRIVATE_ES_EXCHANGE_PRICE_COLLECTION: UIAPP_PRIVATE_ES_EXCHANGE_PRICE_COLLECTION
      UIAPP_PRIVATE_ES_AUTHORIZATION_TOKEN: UIAPP_PRIVATE_ES_AUTHORIZATION_TOKEN
    memorySize: 256
    timeout: 900
    package:
      exclude:
        - src/**
      include:
        - node_modules/**
        - package.json
        - src/updateFXTechnicalIndicator/updateFXTechnicalIndicator.js
    events:
        - http: # this is an API Gateway HTTP event trigger
            path: /test/updateFXTechnicalIndicator
            method: post
            integration: lambda
            cors: true
            description: Description of what the lambda function does # optional, Description to publish to AWS
            memorySize: 512 # optional, in MB, default is 1024
            timeout: 10
